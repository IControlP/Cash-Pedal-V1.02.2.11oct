# vehicle_database_b.py - Manufacturers starting with 'B'
# Comprehensive vehicle database with accurate trim availability and pricing by year

MANUFACTURERS_B = {
    'BMW': {
        '3 Series': {
            'production_years': (2000, 2025),
            'trims_by_year': {
                2000: {'323i': 27170, '323i Sport': 29170, '328i': 30170, '328i Sport': 32170},
                2001: {'325i': 28270, '325i Sport': 30270, '330i': 33270, '330i Sport': 35270},
                2002: {'325i': 28570, '325i Sport': 30570, '330i': 33570, '330i Sport': 35570, 'M3': 46900},
                2003: {'325i': 28870, '325i Sport': 30870, '330i': 33870, '330i Sport': 35870, 'M3': 47200},
                2004: {'325i': 29170, '325i Sport': 31170, '330i': 34170, '330i Sport': 36170, 'M3': 47500},
                2005: {'325i': 29670, '325i Sport': 31670, '330i': 34670, '330i Sport': 36670, 'M3': 48000},
                2006: {'325i': 29970, '325i Sport': 31970, '330i': 34970, '330i Sport': 36970, 'M3': 48300},
                2007: {'328i': 30400, '328xi': 32100, '335i': 37600, '335xi': 39300, 'M3': 55400},
                2008: {'328i': 31200, '328xi': 32900, '335i': 38400, '335xi': 40100, 'M3': 56300},
                2009: {'328i': 32000, '328xi': 33700, '335i': 39200, '335xi': 40900, 'M3': 57200},
                2010: {'328i': 32800, '328xi': 34500, '335i': 40000, '335xi': 41700, 'M3': 58100},
                2011: {'328i': 33600, '328xi': 35300, '335i': 40800, '335xi': 42500, 'M3': 59000},
                2012: {'328i': 34400, '328i xDrive': 36100, '335i': 41600, '335i xDrive': 43300, 'M3': 59900},
                2013: {'328i': 35195, '328i xDrive': 36895, '335i': 42395, '335i xDrive': 44095, 'M3': 60795},
                2014: {'328i': 35795, '328i xDrive': 37495, '335i': 42995, '335i xDrive': 44695, 'M3': 61595},
                2015: {'320i': 33150, '328i': 36395, '328i xDrive': 38095, '335i': 43595, '335i xDrive': 45295, 'M3': 62395},
                2016: {'320i': 33750, '328i': 37995, '328i xDrive': 39695, '340i': 45495, '340i xDrive': 47195, 'M3': 63195},
                2017: {'320i': 34450, '330i': 38950, '330i xDrive': 40650, '340i': 46250, '340i xDrive': 47950, 'M3': 64950},
                2018: {'320i': 35250, '330i': 39750, '330i xDrive': 41450, '340i': 47050, '340i xDrive': 48750, 'M3': 65750},
                2019: {
                    '330i': 40250,
                    '330i xDrive': 42250,
                    'M340i': 54700,
                    'M340i xDrive': 56700,
                    'M3': 69150
                },
                2020: {
                    '330i': 41250,
                    '330i xDrive': 43250,
                    'M340i': 55700,
                    'M340i xDrive': 57700,
                    'M3': 70150
                },
                2021: {
                    '330i': 42250,
                    '330i xDrive': 44250,
                    'M340i': 56700,
                    'M340i xDrive': 58700,
                    'M3': 71150
                },
                2022: {
                    '330i': 43300,
                    '330i xDrive': 45300,
                    'M340i': 57800,
                    'M340i xDrive': 59800,
                    'M3': 72300,
                    'M3 Competition': 74300
                },
                2023: {
                    '330i': 44600,
                    '330i xDrive': 46600,
                    'M340i': 59100,
                    'M340i xDrive': 61100,
                    'M3': 73600,
                    'M3 Competition': 75600
                },
                2024: {
                    '330i': 45800,
                    '330i xDrive': 47800,
                    'M340i': 60300,
                    'M340i xDrive': 62300,
                    'M3': 74800,
                    'M3 Competition': 76800
                },
                2025: {
                    '330i': 47000,
                    '330i xDrive': 49000,
                    'M340i': 61500,
                    'M340i xDrive': 63500,
                    'M3': 76000,
                    'M3 Competition': 78000
                }
            }
        },
        'X1': {
            'production_years': (2013, 2025),
            'trims_by_year': {
                2013: {'sDrive28i': 31200, 'xDrive28i': 32800},
                2014: {'sDrive28i': 31700, 'xDrive28i': 33300},
                2015: {'sDrive28i': 32200, 'xDrive28i': 33800},
                2016: {'sDrive28i': 34500, 'xDrive28i': 36200},
                2017: {'sDrive28i': 35200, 'xDrive28i': 36900},
                2018: {'sDrive28i': 35900, 'xDrive28i': 37600},
                2019: {'sDrive28i': 36700, 'xDrive28i': 38400},
                2020: {
                    'sDrive28i': 37500,
                    'xDrive28i': 39200
                },
                2021: {
                    'sDrive28i': 38400,
                    'xDrive28i': 40100
                },
                2022: {
                    'sDrive28i': 39300,
                    'xDrive28i': 41000
                },
                2023: {
                    'X1 sDrive28i': 40500,
                    'X1 xDrive28i': 42200
                },
                2024: {
                    'X1 sDrive28i': 41600,
                    'X1 xDrive28i': 43300
                },
                2025: {
                    'X1 sDrive28i': 42700,
                    'X1 xDrive28i': 44400
                }
            }
        },
        'X3': {
            'production_years': (2004, 2025),
            'trims_by_year': {
                2004: {'2.5i': 35000, '3.0i': 40000},
                2005: {'2.5i': 35500, '3.0i': 40500},
                2006: {'2.5i': 36000, '3.0i': 41000},
                2007: {'3.0si': 38300, '3.0si Sport': 40800},
                2008: {'3.0si': 39100, '3.0si Sport': 41600},
                2009: {'3.0si': 39900, '3.0si Sport': 42400},
                2010: {'3.0si': 40700, '3.0si Sport': 43200},
                2011: {'28i': 37400, '35i': 43400},
                2012: {'28i': 38200, '35i': 44200},
                2013: {'sDrive28i': 38995, 'xDrive28i': 40695, 'xDrive35i': 46695},
                2014: {'sDrive28i': 39595, 'xDrive28i': 41295, 'xDrive35i': 47295},
                2015: {'sDrive28i': 40195, 'xDrive28i': 41895, 'xDrive35i': 47895},
                2016: {'sDrive28i': 40795, 'xDrive28i': 42495, 'xDrive35i': 48495},
                2017: {'sDrive28i': 41395, 'xDrive28i': 43095, 'xDrive35i': 49095},
                2018: {
                    'sDrive30i': 42400,
                    'xDrive30i': 44200,
                    'M40i': 54500
                },
                2019: {
                    'sDrive30i': 43300,
                    'xDrive30i': 45100,
                    'M40i': 55400
                },
                2020: {
                    'sDrive30i': 44200,
                    'xDrive30i': 46000,
                    'M40i': 56300
                },
                2021: {
                    'sDrive30i': 45100,
                    'xDrive30i': 46900,
                    'M40i': 57200
                },
                2022: {
                    'sDrive30i': 46000,
                    'xDrive30i': 47800,
                    'M40i': 58100,
                    'X3 M': 70100,
                    'X3 M Competition': 75100
                },
                2023: {
                    'sDrive30i': 47300,
                    'xDrive30i': 49100,
                    'M40i': 59400,
                    'X3 M': 71400,
                    'X3 M Competition': 76400
                },
                2024: {
                    'sDrive30i': 48500,
                    'xDrive30i': 50300,
                    'M40i': 60600,
                    'X3 M': 72600,
                    'X3 M Competition': 77600
                },
                2025: {
                    'sDrive30i': 49700,
                    'xDrive30i': 51500,
                    'M40i': 61800,
                    'X3 M': 73800,
                    'X3 M Competition': 78800
                }
            }
        },
        'X5': {
            'production_years': (2000, 2025),
            'trims_by_year': {
                2000: {'3.0i': 45400, '4.4i': 52400},
                2001: {'3.0i': 45900, '4.4i': 52900, '4.6is': 58900},
                2002: {'3.0i': 46400, '4.4i': 53400, '4.6is': 59400},
                2003: {'3.0i': 46900, '4.4i': 53900, '4.6is': 59900},
                2004: {'3.0i': 47400, '4.4i': 54400, '4.8is': 60400},
                2005: {'3.0i': 47900, '4.4i': 54900, '4.8is': 60900},
                2006: {'3.0i': 48400, '4.4i': 55400, '4.8is': 61400},
                2007: {'3.0si': 48100, '4.8i': 58600},
                2008: {'3.0si': 48900, '4.8i': 59400, 'M': 85400},
                2009: {'3.0si': 49700, '4.8i': 60200, 'M': 86200},
                2010: {'3.0si': 50500, '4.8i': 61000, 'M': 87000},
                2011: {'35i': 50500, '50i': 61500, 'M': 88500},
                2012: {'35i': 51300, '50i': 62300, 'M': 89300},
                2013: {'sDrive35i': 53195, 'xDrive35i': 55095, 'xDrive50i': 66695, 'M': 91095},
                2014: {'sDrive35i': 53795, 'xDrive35i': 55695, 'xDrive50i': 67295, 'M': 91695},
                2015: {'sDrive35i': 54395, 'xDrive35i': 56295, 'xDrive50i': 67895, 'M': 92295},
                2016: {'sDrive35i': 54995, 'xDrive35i': 56895, 'xDrive50i': 68495, 'M': 92895},
                2017: {'sDrive35i': 55595, 'xDrive35i': 57495, 'xDrive50i': 69095, 'M': 93495},
                2018: {'xDrive40i': 58900, 'xDrive50i': 71900, 'M': 104400},
                2019: {
                    'sDrive40i': 60700,
                    'xDrive40i': 62700,
                    'xDrive50i': 75800,
                    'M50i': 82800,
                    'X5 M': 106900,
                    'X5 M Competition': 111900
                },
                2020: {
                    'sDrive40i': 61700,
                    'xDrive40i': 63700,
                    'xDrive50i': 76800,
                    'M50i': 83800,
                    'X5 M': 107900,
                    'X5 M Competition': 112900
                },
                2021: {
                    'sDrive40i': 62700,
                    'xDrive40i': 64700,
                    'xDrive50i': 77800,
                    'M50i': 84800,
                    'X5 M': 108900,
                    'X5 M Competition': 113900
                },
                2022: {
                    'sDrive40i': 63700,
                    'xDrive40i': 65700,
                    'xDrive50i': 78800,
                    'M50i': 85800,
                    'X5 M': 109900,
                    'X5 M Competition': 114900
                },
                2023: {
                    'sDrive40i': 65200,
                    'xDrive40i': 67200,
                    'xDrive50i': 80300,
                    'M50i': 87300,
                    'X5 M': 111400,
                    'X5 M Competition': 116400
                },
                2024: {
                    'sDrive40i': 66600,
                    'xDrive40i': 68600,
                    'xDrive50i': 81700,
                    'M50i': 88700,
                    'X5 M': 112800,
                    'X5 M Competition': 117800
                },
                2025: {
                    'sDrive40i': 68000,
                    'xDrive40i': 70000,
                    'xDrive50i': 83100,
                    'M50i': 90100,
                    'X5 M': 114200,
                    'X5 M Competition': 119200
                }
            }
        },
        'X7': {
            'production_years': (2019, 2025),
            'trims_by_year': {
                2019: {
                    'xDrive40i': 73900,
                    'xDrive50i': 92600,
                    'M50i': 100500
                },
                2020: {
                    'xDrive40i': 74900,
                    'xDrive50i': 93600,
                    'M50i': 101500
                },
                2021: {
                    'xDrive40i': 75900,
                    'xDrive50i': 94600,
                    'M50i': 102500
                },
                2022: {
                    'xDrive40i': 76900,
                    'xDrive50i': 95600,
                    'M50i': 103500,
                    'M60i': 109500
                },
                2023: {
                    'xDrive40i': 78500,
                    'xDrive50i': 97200,
                    'M50i': 105100,
                    'M60i': 111100
                },
                2024: {
                    'xDrive40i': 80000,
                    'xDrive50i': 98700,
                    'M50i': 106600,
                    'M60i': 112600
                },
                2025: {
                    'xDrive40i': 81500,
                    'xDrive50i': 100200,
                    'M50i': 108100,
                    'M60i': 114100
                }
            }
        },
        # Legacy model names for backwards compatibility
        '328i': {
            'production_years': (2007, 2015),
            'trims_by_year': {
                2007: {'328i': 30400, '328xi': 32100},
                2008: {'328i': 31200, '328xi': 32900},
                2009: {'328i': 32000, '328xi': 33700},
                2010: {'328i': 32800, '328xi': 34500},
                2011: {'328i': 33600, '328xi': 35300},
                2012: {'328i': 34400, '328i xDrive': 36100},
                2013: {'328i': 35195, '328i xDrive': 36895},
                2014: {'328i': 35795, '328i xDrive': 37495},
                2015: {'328i': 36395, '328i xDrive': 38095}
            }
        },
        '330i': {
            'production_years': (2016, 2025),
            'trims_by_year': {
                2016: {'330i': 38950, '330i xDrive': 40650},
                2017: {'330i': 38950, '330i xDrive': 40650},
                2018: {'330i': 39750, '330i xDrive': 41450},
                2019: {'330i': 40250, '330i xDrive': 42250},
                2020: {'330i': 41250, '330i xDrive': 43250},
                2021: {'330i': 42250, '330i xDrive': 44250},
                2022: {'330i': 43300, '330i xDrive': 45300},
                2023: {'330i': 44600, '330i xDrive': 46600},
                2024: {'330i': 45800, '330i xDrive': 47800},
                2025: {'330i': 47000, '330i xDrive': 49000}
            }
        },
        '340i': {
            'production_years': (2016, 2018),
            'trims_by_year': {
                2016: {'340i': 45495, '340i xDrive': 47195},
                2017: {'340i': 46250, '340i xDrive': 47950},
                2018: {'340i': 47050, '340i xDrive': 48750}
            }
        },
        'M3': {
            'production_years': (2000, 2025),
            'trims_by_year': {
                2000: {'M3': 41170},
                2001: {'M3': 42270, 'M3 Convertible': 48270},
                2002: {'M3': 46900, 'M3 Convertible': 52900},
                2003: {'M3': 47200, 'M3 Convertible': 53200},
                2004: {'M3': 47500, 'M3 Convertible': 53500},
                2005: {'M3': 48000, 'M3 Convertible': 54000},
                2006: {'M3': 48300, 'M3 Convertible': 54300},
                2007: {'M3': 55400, 'M3 Convertible': 62400},
                2008: {'M3': 56300, 'M3 Convertible': 63300, 'M3 Coupe': 58300},
                2009: {'M3': 57200, 'M3 Convertible': 64200, 'M3 Coupe': 59200},
                2010: {'M3': 58100, 'M3 Convertible': 65100, 'M3 Coupe': 60100},
                2011: {'M3': 59000, 'M3 Convertible': 66000, 'M3 Coupe': 61000},
                2012: {'M3': 59900, 'M3 Convertible': 66900, 'M3 Coupe': 61900},
                2013: {'M3': 60795, 'M3 Convertible': 67795, 'M3 Coupe': 62795},
                2014: {'M3': 61595, 'M3 Convertible': 68595},
                2015: {'M3': 62395},
                2016: {'M3': 63195},
                2017: {'M3': 64950},
                2018: {'M3': 65750},
                2019: {'M3': 69150},
                2020: {'M3': 70150},
                2021: {'M3': 71150},
                2022: {'M3': 72300, 'M3 Competition': 74300},
                2023: {'M3': 73600, 'M3 Competition': 75600},
                2024: {'M3': 74800, 'M3 Competition': 76800},
                2025: {'M3': 76000, 'M3 Competition': 78000}
            }
        },
        'M4': {
            'production_years': (2014, 2025),
            'trims_by_year': {
                2014: {'M4': 65125, 'M4 Convertible': 73125},
                2015: {'M4': 65700, 'M4 Convertible': 73700},
                2016: {'M4': 66500, 'M4 Convertible': 74500},
                2017: {'M4': 67300, 'M4 Convertible': 75300},
                2018: {'M4': 68100, 'M4 Convertible': 76100},
                2019: {'M4': 69150, 'M4 Convertible': 77150},
                2020: {'M4': 70150, 'M4 Convertible': 78150},
                2021: {'M4': 72800, 'M4 Convertible': 80800, 'M4 Competition': 74800},
                2022: {'M4': 73800, 'M4 Convertible': 81800, 'M4 Competition': 75800},
                2023: {'M4': 75100, 'M4 Convertible': 83100, 'M4 Competition': 77100},
                2024: {'M4': 76300, 'M4 Convertible': 84300, 'M4 Competition': 78300},
                2025: {'M4': 77500, 'M4 Convertible': 85500, 'M4 Competition': 79500}
            }
        },
        'M5': {
            'production_years': (2000, 2025),
            'trims_by_year': {
                2000: {'M5': 74900},
                2001: {'M5': 75400},
                2002: {'M5': 75900},
                2003: {'M5': 76400},
                2004: {'M5': 83000},
                2005: {'M5': 83500},
                2006: {'M5': 84000, 'M5 SMG': 86000},
                2007: {'M5': 84500, 'M5 SMG': 86500},
                2008: {'M5': 85300, 'M5 SMG': 87300},
                2009: {'M5': 86100, 'M5 SMG': 88100},
                2010: {'M5': 86900, 'M5 SMG': 88900},
                2011: {'M5': 90200},
                2012: {'M5': 90995},
                2013: {'M5': 91795},
                2014: {'M5': 92595},
                2015: {'M5': 93395},
                2016: {'M5': 94195},
                2017: {'M5': 94995},
                2018: {'M5': 102700, 'M5 Competition': 110000},
                2019: {'M5': 103500, 'M5 Competition': 110800},
                2020: {'M5': 104400, 'M5 Competition': 111700},
                2021: {'M5': 105400, 'M5 Competition': 112700},
                2022: {'M5': 106400, 'M5 Competition': 113700},
                2023: {'M5': 107900, 'M5 Competition': 115200},
                2024: {'M5': 109300, 'M5 Competition': 116600},
                2025: {'M5': 110700, 'M5 Competition': 118000}
            }
        },
        'M8': {
            'production_years': (2020, 2025),
            'trims_by_year': {
                2020: {
                    'M8 Coupe': 130000,
                    'M8 Convertible': 142000,
                    'M8 Gran Coupe': 132000,
                    'M8 Competition Coupe': 138000,
                    'M8 Competition Convertible': 150000,
                    'M8 Competition Gran Coupe': 140000
                },
                2021: {
                    'M8 Coupe': 131300,
                    'M8 Convertible': 143300,
                    'M8 Gran Coupe': 133300,
                    'M8 Competition Coupe': 139300,
                    'M8 Competition Convertible': 151300,
                    'M8 Competition Gran Coupe': 141300
                },
                2022: {
                    'M8 Coupe': 132700,
                    'M8 Convertible': 144700,
                    'M8 Gran Coupe': 134700,
                    'M8 Competition Coupe': 140700,
                    'M8 Competition Convertible': 152700,
                    'M8 Competition Gran Coupe': 142700
                },
                2023: {
                    'M8 Coupe': 134400,
                    'M8 Convertible': 146400,
                    'M8 Gran Coupe': 136400,
                    'M8 Competition Coupe': 142400,
                    'M8 Competition Convertible': 154400,
                    'M8 Competition Gran Coupe': 144400
                },
                2024: {
                    'M8 Coupe': 136000,
                    'M8 Convertible': 148000,
                    'M8 Gran Coupe': 138000,
                    'M8 Competition Coupe': 144000,
                    'M8 Competition Convertible': 156000,
                    'M8 Competition Gran Coupe': 146000
                },
                2025: {
                    'M8 Coupe': 137600,
                    'M8 Convertible': 149600,
                    'M8 Gran Coupe': 139600,
                    'M8 Competition Coupe': 145600,
                    'M8 Competition Convertible': 157600,
                    'M8 Competition Gran Coupe': 147600
                }
            }
        },
        '530i': {
            'production_years': (2017, 2025),
            'trims_by_year': {
                2017: {'530i': 51200, '530i xDrive': 53700},
                2018: {'530i': 52400, '530i xDrive': 54900},
                2019: {'530i': 53400, '530i xDrive': 55900},
                2020: {'530i': 54400, '530i xDrive': 56900},
                2021: {'530i': 55400, '530i xDrive': 57900},
                2022: {'530i': 56400, '530i xDrive': 58900},
                2023: {'530i': 57800, '530i xDrive': 60300},
                2024: {'530i': 59100, '530i xDrive': 61600},
                2025: {'530i': 60400, '530i xDrive': 62900}
            }
        },
        '540i': {
            'production_years': (2017, 2025),
            'trims_by_year': {
                2017: {'540i': 56500, '540i xDrive': 59000},
                2018: {'540i': 57700, '540i xDrive': 60200},
                2019: {'540i': 58700, '540i xDrive': 61200},
                2020: {'540i': 59700, '540i xDrive': 62200},
                2021: {'540i': 60700, '540i xDrive': 63200},
                2022: {'540i': 61700, '540i xDrive': 64200},
                2023: {'540i': 63100, '540i xDrive': 65600},
                2024: {'540i': 64400, '540i xDrive': 66900},
                2025: {'540i': 65700, '540i xDrive': 68200}
            }
        },
        '750i': {
            'production_years': (2009, 2025),
            'trims_by_year': {
                2009: {'750i': 78525, '750Li': 81525, '750i xDrive': 81525, '750Li xDrive': 84525},
                2010: {'750i': 79425, '750Li': 82425, '750i xDrive': 82425, '750Li xDrive': 85425},
                2011: {'750i': 80325, '750Li': 83325, '750i xDrive': 83325, '750Li xDrive': 86325},
                2012: {'750i': 81225, '750Li': 84225, '750i xDrive': 84225, '750Li xDrive': 87225},
                2013: {'750i': 82120, '750Li': 85120, '750i xDrive': 85120, '750Li xDrive': 88120},
                2014: {'750i': 82920, '750Li': 85920, '750i xDrive': 85920, '750Li xDrive': 88920},
                2015: {'750i': 83720, '750Li': 86720, '750i xDrive': 86720, '750Li xDrive': 89720},
                2016: {'750i': 95400, '750i xDrive': 98400, '750Li xDrive': 101400},
                2017: {'750i': 96400, '750i xDrive': 99400, '750Li xDrive': 102400},
                2018: {'750i': 97400, '750i xDrive': 100400, '750Li xDrive': 103400},
                2019: {'750i': 98400, '750i xDrive': 101400, '750Li xDrive': 104400},
                2020: {'750i': 99400, '750i xDrive': 102400, '750Li xDrive': 105400},
                2021: {'750i': 100400, '750i xDrive': 103400, '750Li xDrive': 106400},
                2022: {'750i': 101400, '750i xDrive': 104400, '750Li xDrive': 107400},
                2023: {'750i': 103100, '750i xDrive': 106100, '750Li xDrive': 109100},
                2024: {'750i': 104700, '750i xDrive': 107700, '750Li xDrive': 110700},
                2025: {'750i': 106300, '750i xDrive': 109300, '750Li xDrive': 112300}
            }
        },
        'i3': {
            'production_years': (2014, 2022),
            'trims_by_year': {
                2014: {'i3': 41350, 'i3 with Range Extender': 45200},
                2015: {'i3': 42400, 'i3 with Range Extender': 46250},
                2016: {'i3': 42400, 'i3 with Range Extender': 46250},
                2017: {'i3': 44450, 'i3 with Range Extender': 48300},
                2018: {'i3': 44450, 'i3 with Range Extender': 48300, 'i3s': 47650, 'i3s with Range Extender': 51500},
                2019: {'i3': 44450, 'i3 with Range Extender': 48300, 'i3s': 47650, 'i3s with Range Extender': 51500},
                2020: {'i3': 44450, 'i3 with Range Extender': 48300, 'i3s': 47650, 'i3s with Range Extender': 51500},
                2021: {'i3': 44450, 'i3 with Range Extender': 48300, 'i3s': 47650, 'i3s with Range Extender': 51500},
                2022: {'i3': 44450, 'i3s': 47650}
            }
        },
        'i4': {
            'production_years': (2021, 2025),
            'trims_by_year': {
                2021: {'i4 eDrive40': 55400, 'i4 M50': 67300},
                2022: {'i4 eDrive40': 56395, 'i4 M50': 68295},
                2023: {'i4 eDrive40': 57700, 'i4 M50': 69600},
                2024: {'i4 eDrive40': 58900, 'i4 M50': 70800},
                2025: {'i4 eDrive40': 60100, 'i4 M50': 72000}
            }
        },
        'iX': {
            'production_years': (2022, 2025),
            'trims_by_year': {
                2022: {'iX xDrive50': 83200, 'iX M60': 106095},
                2023: {'iX xDrive50': 85100, 'iX M60': 108000},
                2024: {'iX xDrive50': 86900, 'iX M60': 109800},
                2025: {'iX xDrive50': 88700, 'iX M60': 111600}
            }
        }
    },
    
    'Buick': {
        'Encore': {
            'production_years': (2013, 2022),
            'trims_by_year': {
                2013: {'Encore': 24035, 'Encore Convenience': 24735, 'Encore Leather': 27065, 'Encore Premium': 28065},
                2014: {'Encore': 24270, 'Encore Convenience': 24970, 'Encore Leather': 27300, 'Encore Premium': 28300},
                2015: {'Encore': 23015, 'Encore Convenience': 23715, 'Encore Sport Touring': 25590, 'Encore Leather': 26040, 'Encore Premium': 27040},
                2016: {'Encore': 23200, 'Encore Convenience': 23900, 'Encore Sport Touring': 25775, 'Encore Leather': 26225, 'Encore Premium': 27225},
                2017: {'Encore': 23200, 'Encore Preferred': 24065, 'Encore Sport Touring': 25940, 'Encore Leather': 26390, 'Encore Premium': 27390},
                2018: {'Encore': 23200, 'Encore Preferred': 24065, 'Encore Sport Touring': 25940, 'Encore Leather': 26390, 'Encore Premium': 27390},
                2019: {'Encore': 23200, 'Encore Preferred': 24900, 'Encore Sport Touring': 26775, 'Encore Essence': 28395},
                2020: {
                    'Encore Preferred': 24100,
                    'Encore Sport Touring': 25775,
                    'Encore Essence': 28095
                },
                2021: {
                    'Encore Preferred': 24600,
                    'Encore Sport Touring': 26275,
                    'Encore Essence': 28595
                },
                2022: {
                    'Encore Preferred': 25100,
                    'Encore Sport Touring': 26775,
                    'Encore Essence': 29095
                }
            }
        },
        'Encore GX': {
            'production_years': (2020, 2025),
            'trims_by_year': {
                2020: {
                    'Encore GX Preferred': 25200,
                    'Encore GX Select': 26800,
                    'Encore GX Essence': 29000
                },
                2021: {
                    'Encore GX Preferred': 25700,
                    'Encore GX Select': 27300,
                    'Encore GX Essence': 29500
                },
                2022: {
                    'Encore GX Preferred': 26200,
                    'Encore GX Select': 27800,
                    'Encore GX Essence': 30000
                },
                2023: {
                    'Encore GX Preferred': 26900,
                    'Encore GX Select': 28500,
                    'Encore GX Essence': 30700
                },
                2024: {
                    'Encore GX Preferred': 27500,
                    'Encore GX Select': 29100,
                    'Encore GX Essence': 31300
                },
                2025: {
                    'Encore GX Preferred': 28100,
                    'Encore GX Select': 29700,
                    'Encore GX Essence': 31900
                }
            }
        },
        'Envision': {
            'production_years': (2016, 2025),
            'trims_by_year': {
                2016: {'Envision': 34065, 'Envision Leather': 35635, 'Envision Premium I': 38545, 'Envision Premium II': 42195},
                2017: {'Envision': 31995, 'Envision Essence': 34990, 'Envision Premium I': 37995, 'Envision Premium II': 41995},
                2018: {'Envision': 31995, 'Envision Essence': 34990, 'Envision Premium I': 37995, 'Envision Premium II': 41995},
                2019: {'Envision': 31995, 'Envision Essence': 34990, 'Envision Premium I': 37995, 'Envision Premium II': 41995},
                2020: {'Envision': 31995, 'Envision Essence': 34990, 'Envision Premium I': 37995, 'Envision Premium II': 41995},
                2021: {
                    'Envision Preferred': 32400,
                    'Envision Essence': 35000,
                    'Envision Premium': 38400,
                    'Envision Avenir': 41000
                },
                2022: {
                    'Envision Preferred': 33000,
                    'Envision Essence': 35600,
                    'Envision Premium': 39000,
                    'Envision Avenir': 41600
                },
                2023: {
                    'Envision Preferred': 33900,
                    'Envision Essence': 36500,
                    'Envision Premium': 39900,
                    'Envision Avenir': 42500
                },
                2024: {
                    'Envision Preferred': 34700,
                    'Envision Essence': 37300,
                    'Envision Premium': 40700,
                    'Envision Avenir': 43300
                },
                2025: {
                    'Envision Preferred': 35500,
                    'Envision Essence': 38100,
                    'Envision Premium': 41500,
                    'Envision Avenir': 44100
                }
            }
        },
        'Enclave': {
            'production_years': (2008, 2025),
            'trims_by_year': {
                2008: {'Enclave CX': 36790, 'Enclave CXL': 39510, 'Enclave CXL-2': 42250},
                2009: {'Enclave CX': 36985, 'Enclave CXL': 39705, 'Enclave CXL-2': 42445},
                2010: {'Enclave CX': 37180, 'Enclave CXL': 39900, 'Enclave CXL-2': 42640},
                2011: {'Enclave CX': 37375, 'Enclave CXL': 40095, 'Enclave CXL-2': 42835},
                2012: {'Enclave': 37465, 'Enclave Leather': 40185, 'Enclave Premium': 42925},
                2013: {'Enclave': 38745, 'Enclave Leather': 41465, 'Enclave Premium': 44205},
                2014: {'Enclave': 39270, 'Enclave Leather': 41990, 'Enclave Premium': 44730},
                2015: {'Enclave': 39270, 'Enclave Leather': 41990, 'Enclave Premium': 44730},
                2016: {'Enclave': 39270, 'Enclave Leather': 41990, 'Enclave Premium': 44730},
                2017: {'Enclave': 39270, 'Enclave Leather': 41990, 'Enclave Premium': 44730},
                2018: {
                    'Enclave Essence': 40000,
                    'Enclave Premium': 45795,
                    'Enclave Avenir': 53195
                },
                2019: {
                    'Enclave Essence': 40800,
                    'Enclave Premium': 46595,
                    'Enclave Avenir': 53995
                },
                2020: {
                    'Enclave Essence': 41600,
                    'Enclave Premium': 47395,
                    'Enclave Avenir': 54795
                },
                2021: {
                    'Enclave Essence': 42400,
                    'Enclave Premium': 48195,
                    'Enclave Avenir': 55595
                },
                2022: {
                    'Enclave Essence': 43200,
                    'Enclave Premium': 48995,
                    'Enclave Avenir': 56395
                },
                2023: {
                    'Enclave Essence': 44300,
                    'Enclave Premium': 50100,
                    'Enclave Avenir': 57500
                },
                2024: {
                    'Enclave Essence': 45300,
                    'Enclave Premium': 51100,
                    'Enclave Avenir': 58500
                },
                2025: {
                    'Enclave Essence': 46300,
                    'Enclave Premium': 52100,
                    'Enclave Avenir': 59500
                }
            }
        },
        'LaCrosse': {
            'production_years': (2005, 2019),
            'trims_by_year': {
                2005: {'LaCrosse CX': 23995, 'LaCrosse CXL': 26995, 'LaCrosse CXS': 29995},
                2006: {'LaCrosse CX': 24195, 'LaCrosse CXL': 27195, 'LaCrosse CXS': 30195},
                2007: {'LaCrosse CX': 24395, 'LaCrosse CXL': 27395, 'LaCrosse CXS': 30395},
                2008: {'LaCrosse CX': 24595, 'LaCrosse CXL': 27595, 'LaCrosse Super': 33595},
                2009: {'LaCrosse CX': 24795, 'LaCrosse CXL': 27795, 'LaCrosse Super': 33795},
                2010: {'LaCrosse CX': 27635, 'LaCrosse CXL': 30235, 'LaCrosse CXS': 33235},
                2011: {'LaCrosse CX': 27830, 'LaCrosse CXL': 30430, 'LaCrosse CXS': 33430},
                2012: {'LaCrosse': 31015, 'LaCrosse Leather': 34360, 'LaCrosse Premium I': 36735, 'LaCrosse Premium II': 39485},
                2013: {'LaCrosse': 33015, 'LaCrosse Leather': 36360, 'LaCrosse Premium I': 38735, 'LaCrosse Premium II': 41485},
                2014: {'LaCrosse': 32990, 'LaCrosse Leather': 36335, 'LaCrosse Premium I': 38710, 'LaCrosse Premium II': 41460},
                2015: {'LaCrosse': 32990, 'LaCrosse Leather': 36335, 'LaCrosse Premium I': 38710, 'LaCrosse Premium II': 41460},
                2016: {'LaCrosse': 32990, 'LaCrosse Leather': 36335, 'LaCrosse Premium I': 38710, 'LaCrosse Premium II': 41460},
                2017: {
                    'LaCrosse': 32065,
                    'LaCrosse Essence': 35065,
                    'LaCrosse Premium': 38565,
                    'LaCrosse Sport Touring': 41465
                },
                2018: {
                    'LaCrosse': 32565,
                    'LaCrosse Essence': 35565,
                    'LaCrosse Premium': 39065,
                    'LaCrosse Sport Touring': 41965
                },
                2019: {
                    'LaCrosse': 33065,
                    'LaCrosse Essence': 36065,
                    'LaCrosse Premium': 39565,
                    'LaCrosse Sport Touring': 42465
                }
            }
        },
        'Regal': {
            'production_years': (2011, 2020),
            'trims_by_year': {
                2011: {'Regal CXL': 27830, 'Regal CXL Turbo': 29530},
                2012: {'Regal': 29015, 'Regal Premium I': 31765, 'Regal Premium II': 33015, 'Regal GS': 35310},
                2013: {'Regal': 29015, 'Regal Premium I': 31765, 'Regal Premium II': 33015, 'Regal GS': 35310, 'Regal Turbo': 31320},
                2014: {'Regal': 29990, 'Regal Premium I': 32740, 'Regal Premium II': 33990, 'Regal GS': 36285, 'Regal Turbo': 32295},
                2015: {'Regal': 29990, 'Regal Premium I': 32740, 'Regal Premium II': 33990, 'Regal GS': 36285, 'Regal Turbo': 32295},
                2016: {'Regal': 29990, 'Regal Premium I': 32740, 'Regal Premium II': 33990, 'Regal GS': 36285, 'Regal Turbo': 32295},
                2017: {'Regal': 29990, 'Regal Premium I': 32740, 'Regal Premium II': 33990, 'Regal GS': 36285, 'Regal Turbo': 32295},
                2018: {
                    'Regal Sportback Preferred': 25915,
                    'Regal Sportback Essence': 28915,
                    'Regal Sportback GS': 32990,
                    'Regal TourX Preferred': 29070,
                    'Regal TourX Essence': 32070,
                    'Regal TourX GS': 36145
                },
                2019: {
                    'Regal Sportback Preferred': 26415,
                    'Regal Sportback Essence': 29415,
                    'Regal Sportback GS': 33490,
                    'Regal TourX Preferred': 29570,
                    'Regal TourX Essence': 32570,
                    'Regal TourX GS': 36645
                },
                2020: {
                    'Regal Sportback Preferred': 26915,
                    'Regal Sportback Essence': 29915,
                    'Regal Sportback GS': 33990,
                    'Regal TourX Preferred': 30070,
                    'Regal TourX Essence': 33070,
                    'Regal TourX GS': 37145
                }
            }
        }
    }
}


# Helper functions for accessing the database
def get_manufacturers_b():
    """Get all manufacturers starting with 'B'"""
    return list(MANUFACTURERS_B.keys())

def get_models_for_make_b(make):
    """Get all models for a specific make starting with 'B'"""
    return list(MANUFACTURERS_B.get(make, {}).keys())

def get_production_years_b(make, model):
    """Get production years for a specific make/model starting with 'B'"""
    model_data = MANUFACTURERS_B.get(make, {}).get(model, {})
    return model_data.get('production_years', (2000, 2025))

def get_trims_for_year_b(make, model, year):
    """Get available trims and prices for a specific year"""
    model_data = MANUFACTURERS_B.get(make, {}).get(model, {})
    trims_by_year = model_data.get('trims_by_year', {})
    
    # Return exact year if available
    if year in trims_by_year:
        return trims_by_year[year]
    
    # Find closest year if exact year not available
    available_years = sorted(trims_by_year.keys())
    if not available_years:
        return {}
    
    # Find closest year within production range
    production_start, production_end = get_production_years_b(make, model)
    if year < production_start:
        return trims_by_year.get(production_start, {})
    elif year > production_end:
        return trims_by_year.get(production_end, {})
    else:
        # Find closest available year
        closest_year = min(available_years, key=lambda x: abs(x - year))
        return trims_by_year.get(closest_year, {})

def is_model_available_in_year_b(make, model, year):
    """Check if a model was available in a specific year"""
    start_year, end_year = get_production_years_b(make, model)
    return start_year <= year <= end_year

def get_base_price_b(make, model, year):
    """Get the base (lowest) price for a model in a specific year"""
    trims = get_trims_for_year_b(make, model, year)
    return min(trims.values()) if trims else 0

def get_trim_price_b(make, model, trim, year):
    """Get price for a specific trim in a specific year"""
    trims = get_trims_for_year_b(make, model, year)
    return trims.get(trim, 0)

# Example usage and validation
if __name__ == "__main__":
    # Test the database
    print("Manufacturers starting with 'B':", get_manufacturers_b())
    print("\nBMW models:", get_models_for_make_b('BMW'))
    print("\n3 Series production years:", get_production_years_b('BMW', '3 Series'))
    print("\n2023 3 Series trims:", get_trims_for_year_b('BMW', '3 Series', 2023))
    print("\n2023 3 Series base price:", get_base_price_b('BMW', '3 Series', 2023))
    print("\nIs X7 available in 2010?", is_model_available_in_year_b('BMW', 'X7', 2010))
    print("Is X7 available in 2020?", is_model_available_in_year_b('BMW', 'X7', 2020))
    
    # Test Buick
    print("\nBuick models:", get_models_for_make_b('Buick'))
    print("\n2020 Encore GX trims:", get_trims_for_year_b('Buick', 'Encore GX', 2020))
    print("\nIs LaCrosse available in 2020?", is_model_available_in_year_b('Buick', 'LaCrosse', 2020))