# vehicle_database_r.py - Manufacturers starting with 'R'
# Comprehensive vehicle database with accurate trim availability and pricing by year

MANUFACTURERS_R = {
    "Ram": {
        "1500": {
            "production_years": (2011, 2025),
            "trims_by_year": {
                2011: {
                    "Regular Cab ST": 22170,
                    "Regular Cab SLT": 25170,
                    "Quad Cab ST": 25170,
                    "Quad Cab SLT": 28170,
                    "Crew Cab SLT": 30170,
                    "Crew Cab Sport": 32170,
                    "Crew Cab Laramie": 36170
                },
                2012: {
                    "Regular Cab ST": 22470,
                    "Regular Cab SLT": 25470,
                    "Quad Cab ST": 25470,
                    "Quad Cab SLT": 28470,
                    "Crew Cab SLT": 30470,
                    "Crew Cab Sport": 32470,
                    "Crew Cab Laramie": 36470
                },
                2013: {
                    "Regular Cab ST": 22770,
                    "Regular Cab SLT": 25770,
                    "Quad Cab ST": 25770,
                    "Quad Cab SLT": 28770,
                    "Crew Cab SLT": 30770,
                    "Crew Cab Sport": 32770,
                    "Crew Cab Laramie": 36770
                },
                2014: {
                    "Regular Cab ST": 23070,
                    "Regular Cab SLT": 26070,
                    "Quad Cab ST": 26070,
                    "Quad Cab SLT": 29070,
                    "Crew Cab SLT": 31070,
                    "Crew Cab Sport": 33070,
                    "Crew Cab Laramie": 37070
                },
                2015: {
                    "Regular Cab ST": 23370,
                    "Regular Cab SLT": 26370,
                    "Quad Cab ST": 26370,
                    "Quad Cab SLT": 29370,
                    "Crew Cab SLT": 31370,
                    "Crew Cab Sport": 33370,
                    "Crew Cab Laramie": 37370
                },
                2016: {
                    "Regular Cab ST": 23670,
                    "Regular Cab SLT": 26670,
                    "Quad Cab ST": 26670,
                    "Quad Cab SLT": 29670,
                    "Crew Cab SLT": 31670,
                    "Crew Cab Sport": 33670,
                    "Crew Cab Laramie": 37670
                },
                2017: {
                    "Regular Cab ST": 23970,
                    "Regular Cab SLT": 26970,
                    "Quad Cab ST": 26970,
                    "Quad Cab SLT": 29970,
                    "Crew Cab SLT": 31970,
                    "Crew Cab Sport": 33970,
                    "Crew Cab Laramie": 37970
                },
                2018: {
                    "Regular Cab ST": 24270,
                    "Regular Cab SLT": 27270,
                    "Quad Cab ST": 27270,
                    "Quad Cab SLT": 30270,
                    "Crew Cab SLT": 32270,
                    "Crew Cab Sport": 34270,
                    "Crew Cab Laramie": 38270
                },
                2019: {
                    "Regular Cab Tradesman": 31695,
                    "Regular Cab Express": 33695,
                    "Quad Cab Express": 35695,
                    "Crew Cab Express": 37695,
                    "Crew Cab Big Horn": 39695,
                    "Crew Cab Laramie": 42695,
                    "Crew Cab Longhorn": 48695,
                    "Crew Cab Limited": 50695
                },
                2020: {
                    "Regular Cab Tradesman": 31995,
                    "Regular Cab Express": 33995,
                    "Quad Cab Express": 35995,
                    "Crew Cab Express": 37995,
                    "Crew Cab Big Horn": 39995,
                    "Crew Cab Laramie": 42995,
                    "Crew Cab Longhorn": 48995,
                    "Crew Cab Limited": 50995
                },
                2021: {
                    "Regular Cab Tradesman": 32295,
                    "Regular Cab Express": 34295,
                    "Quad Cab Express": 36295,
                    "Crew Cab Express": 38295,
                    "Crew Cab Big Horn": 40295,
                    "Crew Cab Laramie": 43295,
                    "Crew Cab Longhorn": 49295,
                    "Crew Cab Limited": 51295,
                    "Crew Cab TRX": 71295
                },
                2022: {
                    "Regular Cab Tradesman": 32595,
                    "Regular Cab Express": 34595,
                    "Quad Cab Express": 36595,
                    "Crew Cab Express": 38595,
                    "Crew Cab Big Horn": 40595,
                    "Crew Cab Laramie": 43595,
                    "Crew Cab Longhorn": 49595,
                    "Crew Cab Limited": 51595,
                    "Crew Cab TRX": 71595
                },
                2023: {
                    "Regular Cab Tradesman": 32895,
                    "Regular Cab Express": 34895,
                    "Quad Cab Express": 36895,
                    "Crew Cab Express": 38895,
                    "Crew Cab Big Horn": 40895,
                    "Crew Cab Laramie": 43895,
                    "Crew Cab Longhorn": 49895,
                    "Crew Cab Limited": 51895,
                    "Crew Cab TRX": 71895
                },
                2024: {
                    "Regular Cab Tradesman": 33195,
                    "Regular Cab Express": 35195,
                    "Quad Cab Express": 37195,
                    "Crew Cab Express": 39195,
                    "Crew Cab Big Horn": 41195,
                    "Crew Cab Laramie": 44195,
                    "Crew Cab Longhorn": 50195,
                    "Crew Cab Limited": 52195,
                    "Crew Cab TRX": 72195
                },
                2025: {
                    "Regular Cab Tradesman": 33495,
                    "Regular Cab Express": 35495,
                    "Quad Cab Express": 37495,
                    "Crew Cab Express": 39495,
                    "Crew Cab Big Horn": 41495,
                    "Crew Cab Laramie": 44495,
                    "Crew Cab Longhorn": 50495,
                    "Crew Cab Limited": 52495,
                    "Crew Cab TRX": 72495
                }
            }
        },
        "2500": {
            "production_years": (2011, 2025),
            "trims_by_year": {
                2011: {
                    "Regular Cab ST": 29170,
                    "Regular Cab SLT": 32170,
                    "Crew Cab SLT": 37170,
                    "Crew Cab Laramie": 42170
                },
                2012: {
                    "Regular Cab ST": 29470,
                    "Regular Cab SLT": 32470,
                    "Crew Cab SLT": 37470,
                    "Crew Cab Laramie": 42470
                },
                2013: {
                    "Regular Cab ST": 29770,
                    "Regular Cab SLT": 32770,
                    "Crew Cab SLT": 37770,
                    "Crew Cab Laramie": 42770
                },
                2014: {
                    "Regular Cab Tradesman": 30070,
                    "Regular Cab SLT": 33070,
                    "Crew Cab SLT": 38070,
                    "Crew Cab Laramie": 43070
                },
                2015: {
                    "Regular Cab Tradesman": 30370,
                    "Regular Cab SLT": 33370,
                    "Crew Cab SLT": 38370,
                    "Crew Cab Laramie": 43370
                },
                2016: {
                    "Regular Cab Tradesman": 30670,
                    "Regular Cab SLT": 33670,
                    "Crew Cab SLT": 38670,
                    "Crew Cab Laramie": 43670
                },
                2017: {
                    "Regular Cab Tradesman": 30970,
                    "Regular Cab SLT": 33970,
                    "Crew Cab SLT": 38970,
                    "Crew Cab Laramie": 43970
                },
                2018: {
                    "Regular Cab Tradesman": 31270,
                    "Regular Cab SLT": 34270,
                    "Crew Cab SLT": 39270,
                    "Crew Cab Laramie": 44270
                },
                2019: {
                    "Regular Cab Tradesman": 33395,
                    "Crew Cab Tradesman": 35395,
                    "Crew Cab Big Horn": 38395,
                    "Crew Cab Laramie": 45395,
                    "Crew Cab Limited": 52395
                },
                2020: {
                    "Regular Cab Tradesman": 33695,
                    "Crew Cab Tradesman": 35695,
                    "Crew Cab Big Horn": 38695,
                    "Crew Cab Laramie": 45695,
                    "Crew Cab Limited": 52695
                },
                2021: {
                    "Regular Cab Tradesman": 33995,
                    "Crew Cab Tradesman": 35995,
                    "Crew Cab Big Horn": 38995,
                    "Crew Cab Laramie": 45995,
                    "Crew Cab Limited": 52995
                },
                2022: {
                    "Regular Cab Tradesman": 34295,
                    "Crew Cab Tradesman": 36295,
                    "Crew Cab Big Horn": 39295,
                    "Crew Cab Laramie": 46295,
                    "Crew Cab Limited": 53295
                },
                2023: {
                    "Regular Cab Tradesman": 34595,
                    "Crew Cab Tradesman": 36595,
                    "Crew Cab Big Horn": 39595,
                    "Crew Cab Laramie": 46595,
                    "Crew Cab Limited": 53595
                },
                2024: {
                    "Regular Cab Tradesman": 34895,
                    "Crew Cab Tradesman": 36895,
                    "Crew Cab Big Horn": 39895,
                    "Crew Cab Laramie": 46895,
                    "Crew Cab Limited": 53895
                },
                2025: {
                    "Regular Cab Tradesman": 35195,
                    "Crew Cab Tradesman": 37195,
                    "Crew Cab Big Horn": 40195,
                    "Crew Cab Laramie": 47195,
                    "Crew Cab Limited": 54195
                }
            }
        },
        "3500": {
            "production_years": (2011, 2025),
            "trims_by_year": {
                2011: {
                    "Regular Cab ST": 32170,
                    "Regular Cab SLT": 35170,
                    "Crew Cab SLT": 40170,
                    "Crew Cab Laramie": 45170
                },
                2012: {
                    "Regular Cab ST": 32470,
                    "Regular Cab SLT": 35470,
                    "Crew Cab SLT": 40470,
                    "Crew Cab Laramie": 45470
                },
                2013: {
                    "Regular Cab ST": 32770,
                    "Regular Cab SLT": 35770,
                    "Crew Cab SLT": 40770,
                    "Crew Cab Laramie": 45770
                },
                2014: {
                    "Regular Cab Tradesman": 33070,
                    "Regular Cab SLT": 36070,
                    "Crew Cab SLT": 41070,
                    "Crew Cab Laramie": 46070
                },
                2015: {
                    "Regular Cab Tradesman": 33370,
                    "Regular Cab SLT": 36370,
                    "Crew Cab SLT": 41370,
                    "Crew Cab Laramie": 46370
                },
                2016: {
                    "Regular Cab Tradesman": 33670,
                    "Regular Cab SLT": 36670,
                    "Crew Cab SLT": 41670,
                    "Crew Cab Laramie": 46670
                },
                2017: {
                    "Regular Cab Tradesman": 33970,
                    "Regular Cab SLT": 36970,
                    "Crew Cab SLT": 41970,
                    "Crew Cab Laramie": 46970
                },
                2018: {
                    "Regular Cab Tradesman": 34270,
                    "Regular Cab SLT": 37270,
                    "Crew Cab SLT": 42270,
                    "Crew Cab Laramie": 47270
                },
                2019: {
                    "Regular Cab Tradesman": 35395,
                    "Crew Cab Tradesman": 37395,
                    "Crew Cab Big Horn": 40395,
                    "Crew Cab Laramie": 47395,
                    "Crew Cab Limited": 54395
                },
                2020: {
                    "Regular Cab Tradesman": 35695,
                    "Crew Cab Tradesman": 37695,
                    "Crew Cab Big Horn": 40695,
                    "Crew Cab Laramie": 47695,
                    "Crew Cab Limited": 54695
                },
                2021: {
                    "Regular Cab Tradesman": 35995,
                    "Crew Cab Tradesman": 37995,
                    "Crew Cab Big Horn": 40995,
                    "Crew Cab Laramie": 47995,
                    "Crew Cab Limited": 54995
                },
                2022: {
                    "Regular Cab Tradesman": 36295,
                    "Crew Cab Tradesman": 38295,
                    "Crew Cab Big Horn": 41295,
                    "Crew Cab Laramie": 48295,
                    "Crew Cab Limited": 55295
                },
                2023: {
                    "Regular Cab Tradesman": 36595,
                    "Crew Cab Tradesman": 38595,
                    "Crew Cab Big Horn": 41595,
                    "Crew Cab Laramie": 48595,
                    "Crew Cab Limited": 55595
                },
                2024: {
                    "Regular Cab Tradesman": 36895,
                    "Crew Cab Tradesman": 38895,
                    "Crew Cab Big Horn": 41895,
                    "Crew Cab Laramie": 48895,
                    "Crew Cab Limited": 55895
                },
                2025: {
                    "Regular Cab Tradesman": 37195,
                    "Crew Cab Tradesman": 39195,
                    "Crew Cab Big Horn": 42195,
                    "Crew Cab Laramie": 49195,
                    "Crew Cab Limited": 56195
                }
            }
        },
        "ProMaster": {
            "production_years": (2014, 2025),
            "trims_by_year": {
                2014: {
                    "1500 Low Roof": 28595,
                    "1500 High Roof": 30595,
                    "2500 Low Roof": 31595,
                    "2500 High Roof": 33595,
                    "3500 Low Roof": 34595,
                    "3500 High Roof": 36595
                },
                2015: {
                    "1500 Low Roof": 28895,
                    "1500 High Roof": 30895,
                    "2500 Low Roof": 31895,
                    "2500 High Roof": 33895,
                    "3500 Low Roof": 34895,
                    "3500 High Roof": 36895
                },
                2016: {
                    "1500 Low Roof": 29195,
                    "1500 High Roof": 31195,
                    "2500 Low Roof": 32195,
                    "2500 High Roof": 34195,
                    "3500 Low Roof": 35195,
                    "3500 High Roof": 37195
                },
                2017: {
                    "1500 Low Roof": 29495,
                    "1500 High Roof": 31495,
                    "2500 Low Roof": 32495,
                    "2500 High Roof": 34495,
                    "3500 Low Roof": 35495,
                    "3500 High Roof": 37495
                },
                2018: {
                    "1500 Low Roof": 29795,
                    "1500 High Roof": 31795,
                    "2500 Low Roof": 32795,
                    "2500 High Roof": 34795,
                    "3500 Low Roof": 35795,
                    "3500 High Roof": 37795
                },
                2019: {
                    "1500 Low Roof": 30095,
                    "1500 High Roof": 32095,
                    "2500 Low Roof": 33095,
                    "2500 High Roof": 35095,
                    "3500 Low Roof": 36095,
                    "3500 High Roof": 38095
                },
                2020: {
                    "1500 Low Roof": 30395,
                    "1500 High Roof": 32395,
                    "2500 Low Roof": 33395,
                    "2500 High Roof": 35395,
                    "3500 Low Roof": 36395,
                    "3500 High Roof": 38395
                },
                2021: {
                    "1500 Low Roof": 30695,
                    "1500 High Roof": 32695,
                    "2500 Low Roof": 33695,
                    "2500 High Roof": 35695,
                    "3500 Low Roof": 36695,
                    "3500 High Roof": 38695
                },
                2022: {
                    "1500 Low Roof": 30995,
                    "1500 High Roof": 32995,
                    "2500 Low Roof": 33995,
                    "2500 High Roof": 35995,
                    "3500 Low Roof": 36995,
                    "3500 High Roof": 38995
                },
                2023: {
                    "1500 Low Roof": 31295,
                    "1500 High Roof": 33295,
                    "2500 Low Roof": 34295,
                    "2500 High Roof": 36295,
                    "3500 Low Roof": 37295,
                    "3500 High Roof": 39295
                },
                2024: {
                    "1500 Low Roof": 31595,
                    "1500 High Roof": 33595,
                    "2500 Low Roof": 34595,
                    "2500 High Roof": 36595,
                    "3500 Low Roof": 37595,
                    "3500 High Roof": 39595
                },
                2025: {
                    "1500 Low Roof": 31895,
                    "1500 High Roof": 33895,
                    "2500 Low Roof": 34895,
                    "2500 High Roof": 36895,
                    "3500 Low Roof": 37895,
                    "3500 High Roof": 39895
                }
            }
        }
    }
}

# Helper functions for accessing Database R
def get_manufacturers_r():
    """Get all manufacturers starting with 'R'"""
    return list(MANUFACTURERS_R.keys())

def get_models_for_make_r(make):
    """Get all models for a specific make starting with 'R'"""
    return list(MANUFACTURERS_R.get(make, {}).keys())

def get_production_years_r(make, model):
    """Get production years for a specific make/model starting with 'R'"""
    model_data = MANUFACTURERS_R.get(make, {}).get(model, {})
    return model_data.get('production_years', (2000, 2025))

def get_trims_for_year_r(make, model, year):
    """Get available trims and prices for a specific year"""
    model_data = MANUFACTURERS_R.get(make, {}).get(model, {})
    trims_by_year = model_data.get('trims_by_year', {})
    
    # Return exact year if available
    if year in trims_by_year:
        return trims_by_year[year]
    
    # Find closest year if exact year not available
    available_years = sorted(trims_by_year.keys())
    if not available_years:
        return {}
    
    # Find closest year within production range
    production_start, production_end = get_production_years_r(make, model)
    if year < production_start:
        return trims_by_year.get(production_start, {})
    elif year > production_end:
        return trims_by_year.get(production_end, {})
    else:
        # Find closest available year
        closest_year = min(available_years, key=lambda x: abs(x - year))
        return trims_by_year.get(closest_year, {})

def is_model_available_in_year_r(make, model, year):
    """Check if a model was available in a specific year"""
    start_year, end_year = get_production_years_r(make, model)
    return start_year <= year <= end_year

def get_base_price_r(make, model, year):
    """Get the base (lowest) price for a model in a specific year"""
    trims = get_trims_for_year_r(make, model, year)
    return min(trims.values()) if trims else 0

def get_trim_price_r(make, model, trim, year):
    """Get price for a specific trim in a specific year"""
    trims = get_trims_for_year_r(make, model, year)
    return trims.get(trim, 0)

# Example usage and validation
if __name__ == "__main__":
    # Test the database
    print("Manufacturers starting with 'R':", get_manufacturers_r())
    print("\nRam models:", get_models_for_make_r('Ram'))
    print("\nRam 1500 production years:", get_production_years_r('Ram', '1500'))
    print("\n2023 Ram 1500 trims:", get_trims_for_year_r('Ram', '1500', 2023))
    print("\n2023 Ram 1500 base price:", get_base_price_r('Ram', '1500', 2023))
    print("\nIs Ram 2500 available in 2010?", is_model_available_in_year_r('Ram', '2500', 2010))
    print("Is Ram 2500 available in 2020?", is_model_available_in_year_r('Ram', '2500', 2020))
    
    # Test other models
    print("\n2020 Ram 3500 trims:", list(get_trims_for_year_r('Ram', '3500', 2020).keys()))
    print("\n2024 ProMaster 3500 High Roof price:", get_trim_price_r('Ram', 'ProMaster', '3500 High Roof', 2024))
    print("\nIs ProMaster available in 2013?", is_model_available_in_year_r('Ram', 'ProMaster', 2013))
    print("\n2025 Ram 1500 TRX price:", get_trim_price_r('Ram', '1500', 'Crew Cab TRX', 2025))